<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Arduino IC Tester</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🔌 Arduino IC Tester</h1>
            <p>Universal Web Interface - UNO/Mega Compatible</p>
        </div>
        
        <div class="connection-bar">
            <div class="form-group" style="display: inline-block; margin-right: 20px;">
                <label style="color: white; margin-right: 10px;">Board Type:</label>
                <select id="boardSelector" onchange="updateBoardType()" style="padding: 8px;">
                    <option value="UNO">Arduino UNO (D2-D13)</option>
                    <option value="MEGA">Arduino Mega (D22-D33)</option>
                </select>
            </div>
            <button id="connectBtn" class="btn-primary">Connect to Arduino</button>
            <span id="status" class="status disconnected">Disconnected</span>
        </div>

        <div class="content">
            <!-- IC Type Selection -->
            <div class="section">
                <h2>Select IC Type</h2>
                <div class="form-group">
                    <label>What type of IC do you want to test?</label>
                    <select id="icTypeSelector" onchange="showICInterface()">
                        <option value="">-- Select IC Type --</option>
                        <option value="logic-gate">Logic Gates (7404, 7408, 7432, etc.)</option>
                        <option value="multiplexer">Multiplexer (74151, 74153, etc.)</option>
                        <option value="counter">Counter (7490, 7493, 74193, etc.)</option>
                        <option value="flipflop">Flip-Flop (7474, 7476, etc.)</option>
                        <option value="analog">Analog IC</option>
                    </select>
                </div>
            </div>

            <!-- ==================== LOGIC GATES INTERFACE ==================== -->
            <div id="logic-gate-interface" class="ic-interface" style="display: none;">
                <div class="section">
                    <h2>Logic Gate Configuration</h2>
                    <div class="form-group">
                        <label>IC Name:</label>
                        <input type="text" id="icName" placeholder="e.g., 7404, 7432">
                    </div>
                    
                    <div class="btn-group">
                        <button class="btn-primary" onclick="openGateDialog()">➕ Add Gate</button>
                        <button class="btn-secondary" onclick="clearGates()">🗑️ Clear All</button>
                        <button class="btn-secondary" onclick="loadFromJSON()">📁 Load JSON</button>
                        <button class="btn-secondary" onclick="saveToJSON()">💾 Save JSON</button>
                    </div>
                    
                    <div class="gate-list" id="gatesList">
                        <p style="color: #999;">No gates configured yet</p>
                    </div>
                </div>
                
                <div class="section">
                    <h2>Actions</h2>
                    <div class="btn-group">
                        <button class="btn-success" onclick="testIC()">🧪 Test IC</button>
                        <button class="btn-secondary" onclick="viewBinary()">👁️ View Binary Packet</button>
                    </div>
                </div>
                
                <div class="section">
                    <h2>Test Results</h2>
                    <div class="result-box" id="results">Waiting for test...</div>
                </div>
            </div>

          <!-- MULTIPLEXER INTERFACE -->
<div id="multiplexer-interface" class="ic-interface" style="display: none;">
    <div class="section">
        <h2>⚡ Multiplexer/Demultiplexer Tester</h2>
        
        <div class="form-group">
            <label for="muxMode">Mode:</label>
            <select id="muxMode" onchange="updateMuxUI()">
                <option value="">-- Select Mode --</option>
                <option value="mux">Multiplexer (MUX)</option>
                <option value="demux">Demultiplexer (DEMUX)</option>
            </select>
        </div>

        <div class="form-group">
            <label for="muxType">Type:</label>
            <select id="muxType" onchange="updateMuxUI()">
                <option value="">-- Select Type --</option>
            </select>
        </div>

        <div id="muxPinConfig"></div>

        <button class="btn-primary" onclick="runMuxTest()" style="margin-top: 20px;">
            🧪 Run Test
        </button>
    </div>

    <div class="section">
        <h2>Test Results</h2>
        <div id="muxResults" class="result-box">
            Waiting for test...
        </div>
    </div>
</div>




            <!-- ==================== COUNTER INTERFACE ==================== -->
            <div id="counter-interface" class="ic-interface" style="display: none;">
  <h2>Counter Testing</h2>

  <div class="form-group">
    <label>Select Counter IC:</label>
    <select id="counterType" onchange="updateCounterPinUI()">
      <option value="">-- Select Type --</option>
      <option value="4017">4017 (Decade Counter)</option>
      <option value="7493">7493 (4-bit Binary Counter)</option>
    </select>
  </div>

  <div class="form-group">
    <label>Pin Configuration Mode:</label>
    <select id="counterPinMode" onchange="updateCounterPinUI()">
      <option value="auto">Use Default</option>
      <option value="manual">Manual Entry</option>
    </select>
  </div>

  <div id="counterPinConfig"></div>

  <div class="form-group">
    <label>Number of Pulses to Apply:</label>
    <input type="number" id="counterPulses" min="1" max="50" value="10">
  </div>

  <button onclick="testCounter()">Test Counter</button>

  <div id="counterResults" class="output-box"></div>
</div>

            <!-- ==================== FLIP-FLOP INTERFACE ==================== -->
            <div id="flipflop-interface" class="ic-interface" style="display: none;">
  <div class="section">
    <h2>Flip-Flop Configuration</h2>

    <div class="form-group">
      <label>IC Name:</label>
      <input type="text" id="ffName" placeholder="e.g., 7474 (dual D FF)">
    </div>

    <div class="form-group">
      <label>Number of Flip-Flops in IC:</label>
      <select id="numFFs" onchange="updateFFCount()">
        <option value="1">1 Flip-Flop</option>
        <option value="2" selected>2 Flip-Flops</option>
        <option value="3">3 Flip-Flops</option>
        <option value="4">4 Flip-Flops</option>
      </select>
    </div>

    <div class="form-group">
      <label><input type="checkbox" id="sameTypeToggle" checked> Use Same Type for All Flip-Flops</label>
    </div>

    <div id="ffConfigContainer"></div>

    <div class="btn-group" style="margin-top: 12px;">
      <button class="btn-success" onclick="testFlipFlops()">🧪 Test Flip-Flops</button>
      <button class="btn-secondary" onclick="saveFFConfig()">💾 Save Config</button>
      <button class="btn-secondary" onclick="loadFFConfig()">📁 Load Config</button>
    </div>
  </div>

  <div class="section">
    <h2>Test Results</h2>
    <div class="result-box" id="ffResults">Waiting for test...</div>
  </div>
</div>
<!-- ==================== ANALOG INTERFACE (NE555 TIMER) ==================== -->
<div id="analog-interface" class="ic-interface" style="display: none;">
  <div class="section">
    <h2>Analog IC Testing - NE555 Timer</h2>
    <p>This test checks the <strong>NE555 timer</strong> in astable mode (≈80 Hz).</p>

    <div class="btn-group">
      <button class="btn-success" onclick="testNE555()">🧪 Test NE555 Timer</button>
    </div>

    <div class="section">
      <h2>Test Results</h2>
      <div id="analogResults" class="result-box">Waiting for test...</div>
    </div>
  </div>
</div>
        </div>
    </div>
    
    <!-- ==================== ADD GATE MODAL ==================== -->
    <div class="modal" id="gateModal">
        <div class="modal-content">
            <h2>Add Gate Configuration</h2>
            
            <div class="form-group">
                <label>Number of Inputs:</label>
                <select id="numInputs" onchange="updatePinSelectors()">
                    <option value="1">1</option>
                    <option value="2" selected>2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                </select>
            </div>
            
            <div class="form-group">
                <label>Number of Outputs:</label>
                <select id="numOutputs" onchange="updatePinSelectors()">
                    <option value="1" selected>1</option>
                    <option value="2">2</option>
                </select>
            </div>
            
            <div class="form-group">
                <label>Input Pins:</label>
                <div class="pin-selects" id="inputPins"></div>
            </div>
            
            <div class="form-group">
                <label>Output Pins:</label>
                <div class="pin-selects" id="outputPins"></div>
            </div>
            
            <div class="form-group">
                <label>Truth Table:</label>
                <div class="truth-table" id="truthTable"></div>
            </div>
            
            <div class="btn-group">
                <button class="btn-success" onclick="saveGate()">Save Gate</button>
                <button class="btn-secondary" onclick="closeGateDialog()">Cancel</button>
            </div>
        </div>
    </div>
    
    <script src="app.js"></script>
</body>
</html>
